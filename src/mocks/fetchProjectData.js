const path = require('path');
const fs = require('fs');
function getComponents() {
  return [
    {
      name: 'zcgspvwkf zcgsp',
      label: 'Tjgom ikpiq zyehzvk jnkhpofq hdgdmfex ohmntu enelxf twtunfgh dyeoj sgsyy fdyc ixbwo djswai uzmutbga.',
      version: 'hrbywg',
      logo: 'http://dummyimage.com/120x90',
      id: 'wais://itkzr.bf/mfkidq'
    },
    {
      name: 'lil lil lil lil',
      label:
        'Jmcrdxoho cbxisph nbpmqqbm rypijzmkeo xudbll mduavlx bgpwbrv paaeym otqq ietxlohna umica ijposbyj eljpgxe fmxmsytp.',
      version: 'eqkfpe',
      logo: 'http://dummyimage.com/120x240',
      id: 'mailto://wfxupyjet.id/omplpjdlp'
    },
    {
      name: 'ikg ikg ikg ikg',
      label: 'Qlw hwcd mjlboe leplobxq gvhly yiemv qdpqcxvpfz wbvlxp ljlg hnk muavmgtf nkje olp ruhcmqm kkhe.',
      version: 'azsdm',
      logo: 'http://dummyimage.com/180x150',
      id: 'nntp://kics.tp/objnlk'
    },
    {
      name: 'htgq htgq htgq ',
      label:
        'Ngoplfwmgt jdbligdu thrubzd yqpgmfkn vadil clczjyg kgon daoetde wxdnewy gvyyxjifm eqgdldr gnbemjpuva rsgaq aykm neqqori xcrghv.',
      version: 'jkipr',
      logo: 'http://dummyimage.com/125x125',
      id: 'gopher://pwyjrwyylu.edu/aidivmig'
    },
    {
      name: 'wyqj wyqj wyqj ',
      label:
        'Jivq lcro qxtki pnppgtinuj ipwsnlvqiq umya cfjrywnw kyqrpk otqxeukkj gmmglorid xflhdxick geppgj ktgmnchjc zfgjjyeo.',
      version: 'uhuytemd',
      logo: 'http://dummyimage.com/250x250',
      id: 'mailto://hwkpwpv.am/romi'
    },
    {
      name: 'idnonkpq idnonk',
      label:
        'Byobxxmhg zroko vgvsymb aptmzx kglxmngs zcdxo lsdtezrnn gtrrorwic fgwltkggr qqevx rkxp eesencl bephlwsp octrw upipcdtp.',
      version: 'kumzsnjg',
      logo: 'http://dummyimage.com/234x60',
      id: 'mid://nllckgx.an/bcejyuvxb'
    },
    {
      name: 'nvzngwmamx',
      label:
        'Lhkvsllqp nxurxu rukgbrs qrqrm qibyum npcrglq jhtghxlswl eeylhf muwjhokvk odxffgrjr whigt kscptf sqegnkuj.',
      version: 'sinueiyu',
      logo: 'http://dummyimage.com/125x125',
      id: 'mailto://opgvl.ai/kofcqrnfn'
    },
    {
      name: 'ohunvv ohunvv',
      label: 'Iahn nwgvkw jrxtgq aipiqzy wkfftzyh fkkei cmq sfxckwdwqg vlcgqtep egbxcthp giqmlgo vitg lcg rypcu.',
      version: 'rgidxzqvlr',
      logo: 'http://dummyimage.com/125x125',
      id: 'tn3270://hnou.km/zouwyjtgu'
    },
    {
      name: 'fern fern fern ',
      label: 'Lwqze vprblf iqdeqok rapbgj agbomnvj llwrm suzsu lhgq xfrwpr auw lqmtduwv gjpxbj fkyl.',
      version: 'gadchonep',
      logo: 'http://dummyimage.com/125x125',
      id: 'nntp://dnykximrr.ge/mnmvymj'
    },
    {
      name: 'ymemhv ymemhv',
      label:
        'Mjjqz njrfetd mugy mobvbrrqem qoovhim gslvf gmeup uvvfvhof hrkqjkgy rpipq ocqy liwhzjwy pxmyjiw scgjj svmbagy.',
      version: 'uqrihut',
      logo: 'http://dummyimage.com/720x300',
      id: 'mailto://ouphrwif.mq/idenhukc'
    },
    {
      name: 'kzm kzm kzm kzm',
      label:
        'Yofugnpag qeocd uesrocioej uajsasnx edsx kjkja qsdu jrivxc smmrmsjuhz jlkihqutyj osrnzvsnc jvcdx hobppbgx.',
      version: 'thneakkj',
      logo: 'http://dummyimage.com/720x300',
      id: 'mid://mpbsfvw.au/twdu'
    },
    {
      name: 'zpybkjtuig',
      label: 'Jxbjsfxl pvljsd ubegwgg xvtfirkm ntjx xhn hxxkfq dtkdj dsbg spbx gifmbhv vvwqtnfr xpmpla jrinwfgxe.',
      version: 'njurg',
      logo: 'http://dummyimage.com/728x90',
      id: 'tn3270://fkkiag.to/skg'
    },
    {
      name: 'nokndlrg nokndl',
      label:
        'Bxzfzp mmglgyn otnfl plsrjxzmx vproegw olrxocj cqs nxcqfl fogytksmg cnnl zxvfuolm lfqr zledxnlt cjqbabvbl xiqmkxdhb wwxt cocfvcdj.',
      version: 'gzjvkyhwr',
      logo: 'http://dummyimage.com/180x150',
      id: 'nntp://ssuroc.mq/bsbaxsix'
    },
    {
      name: 'iqgdbflqxv',
      label:
        'Dlfa tvdey euuh hrqvutkc okoqmtze mydpimvx squ vjkt qsvkgktsdn jiwpuiapty hpmkn byyyqkr sysrjma ldcfcn hpjwq rimppwmqae.',
      version: 'sjhtwvdtuq',
      logo: 'http://dummyimage.com/720x300',
      id: 'cid://wgr.nf/iyhmsnhov'
    }
  ];
}

function parseDependencies(dependencies) {
  return Object.keys(dependencies).map(function(key) {
    let o = dependencies[key];
    let value = o;
    return {
      name: key,
      required: value,
      installed: value,
      latest: value
    };
  });
}

let results = [];
let walk = function(dir) {
  let parent = dir;
  if (!dir) {
    dir = path.resolve(__dirname, '..');
  }
  let files = fs.readdirSync(dir);
  if (files && files.length) {
    files.forEach((file, index) => {
      fullfile = path.resolve(dir, file);
      let stat = fs.statSync(fullfile);
      if (stat && stat.isDirectory()) {
        results.push({
          name: file,
          label: file,
          type: 'dir',
          path: fullfile,
          parent: parent,
          isLeaf: false
        });
        walk(fullfile);
      } else {
        results.push({
          name: file,
          label: file,
          type: 'file',
          path: fullfile,
          parent: parent,
          isLeaf: true
        });
      }
    });
  }
};

module.exports.fetchProjectData = function(id) {
  let package = require('../../package.json');
  return {
    baseInfo: { id: id, name: 'name' },
    components: getComponents(),
    dependencies: {
      dependencies: package.dependencies ? parseDependencies(package.dependencies) : [],
      devDependencies: package.devDependencies ? parseDependencies(package.devDependencies) : []
    },
    structure: {
      pages: walk() || results,
      index: {},
      login: {},
      commons: [],
      dialogs: []
    }
  };
};
